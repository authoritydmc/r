{% extends "base.html" %}
{% block title %}Admin Config - URL Shortener/Redirector{% endblock %}

{% block content %}
<div class="flex items-center justify-center min-h-[calc(100vh-160px)]">
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-8 w-full max-w-2xl text-center">
    <h1 class="text-2xl font-bold text-blue-700 dark:text-blue-200 mb-4 flex items-center gap-2"><i class="fa-solid fa-gear"></i> Admin Config</h1>
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="mb-4 px-4 py-2 rounded {{ 'bg-green-100 border border-green-300 text-green-800' if category == 'success' else 'bg-red-100 border border-red-300 text-red-800' }}">{{ message }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}
    <form method="post" class="space-y-4" id="config-form">
      {% for k, v in config_data.items() %}
        <div class="flex flex-col sm:flex-row sm:items-center gap-2 relative group items-center hover:bg-blue-50 dark:hover:bg-gray-700 rounded transition">
          <label class="font-semibold w-40 text-gray-700 dark:text-gray-200">{{ k }}</label>
          <div class="flex-1 flex items-center gap-2">
            <input name="{{ k }}" value="{{ v }}" class="px-2 py-1 rounded border border-gray-300 dark:bg-gray-900 dark:text-gray-100" readonly />
            <button type="button" class="edit-btn text-gray-500 hover:text-blue-600 ml-1 opacity-0 group-hover:opacity-100 transition-opacity" title="Edit"><i class="fa-solid fa-pen"></i></button>
          </div>
        </div>
      {% endfor %}
      <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 font-semibold shadow flex items-center gap-2"><i class="fa-solid fa-save"></i> Save Config</button>
    </form>
    <a href="/" class="text-blue-600 dark:text-blue-400 hover:underline mt-4 block">‚Üê Back to Dashboard</a>
  </div>
</div>
{% endblock %}
{% block scripts %}
<script>
// Per-field edit logic
[...document.querySelectorAll('.edit-btn')].forEach(function(btn) {
  btn.addEventListener('click', function() {
    const parent = btn.closest('.flex-1');
    if (!parent) return;
    const input = parent.querySelector('input, select');
    if (!input) return;
    input.readOnly = false;
    input.disabled = false;
    input.classList.remove('text-gray-400', 'dark:text-gray-500');
    input.classList.add('text-black', 'dark:text-white');
    input.focus();
    btn.classList.add('text-blue-600');
    input.addEventListener('blur', function handler() {
      input.readOnly = true;
      input.disabled = true;
      input.classList.remove('text-black', 'dark:text-white');
      input.classList.add('text-gray-400', 'dark:text-gray-500');
      btn.classList.remove('text-blue-600');
      input.removeEventListener('blur', handler);
    });
  });
});
</script>
{% endblock %}
